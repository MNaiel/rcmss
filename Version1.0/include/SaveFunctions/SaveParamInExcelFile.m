%% Save the results of each iteration in excel file
if ResultsOpts.SaveResultsFlag==1
    SystemParametersCellStartNumIndex=UpdateIndexExcelResults(ResultsOpts.SaveResultsFlag,ResultsOpts.SaveParameters,ResultsOpts.SheetName);
    SystemParametersCellStartNumIndex=SystemParametersCellStartNumIndex+1;
    SystemParametersCellStartNum=strcat('A',num2str(SystemParametersCellStartNumIndex));
    SystemParameters1={ClearMOT.MOTP ,ClearMOT.MOTA ,ClearMOT.rateFN ,ClearMOT.rateFP ,ClearMOT.rateTP ,ClearMOT.TP ,ClearMOT.FN ,ClearMOT.FP ,ClearMOT.IDSW,...
        TrackerOpt.AM.SDC.update.SDCUpdateRate, TrackerOpt.MM.opt.numsample, ConvertVector2String(TrackerOpt.MM.opt.affsig,'%3.2f'), ConvertVector2String(TrackerOpt.MM.Occlusionaffsig,'%3.2f'), ...
        TrackerOpt.MM.VelocityMotionModel.Sigmax,TrackerOpt.MM.VelocityMotionModel.SigmaVx,TrackerOpt.MM.VelocityMotionModel.Window, TrackerOpt.AM.sz(1), TrackerOpt.AM.sz(2), ConvertVector2String(TrackerOpt.AM.sz,'%3.2f'), TrackerOpt.AM.SDC.update.num_p_Init, ...
        TrackerOpt.AM.SDC.update.num_n_Init, TrackerOpt.AM.SGM.patchsize, TrackerOpt.AM.SGM.Fisize,ConvertVector2String(TrackerOpt.MM.SigmaAffineNegSamples,'%3.2f'),...
        ConvertVector2String(TrackerOpt.MM.opt.affsig,'%3.2f'),ConvertVector2String(TrackerOpt.MM.Occlusionaffsig,'%3.2f'),ConvertVector2String(TrackerOpt.MM.Mergeaffsig,'%3.2f') };
    SystemParameters2={ClearMOT.MOTP ,ClearMOT.MOTA ,ClearMOT.rateFN ,ClearMOT.rateFP ,ClearMOT.rateTP ,ClearMOT.TP ,ClearMOT.FN ,ClearMOT.FP ,ClearMOT.IDSW, ...
        TrackerOpt.DA.OverlapForNewTracker, TrackerOpt.DA.ThresholdSimilarity, TrackerOpt.DA.Factor, TrackerOpt.DA.ConflictThreshold, TrackerOpt.DA.NonConflictThreshold, TrackerOpt.CM.AdjustWidthandHeight, [], DetectorObj.ThresholdDetector,...
        TrackerOpt.DA.ThresholdOcclusion,TrackerOpt.DA.ThresholdwithOutOcclusion,TrackerOpt.DA.GetBackThreshold, TrackerOpt.CM.EnableDetectorGuide,TrackerOpt.CM.UseBeforeorAfterNonMaxSup,TrackerOpt.MM.USEGateFunction,TrackerOpt.MM.UseMotionModelAffineORVecolity1,...
        TrackerOpt.MM.UseMotionModelAffineORVecolity2,TrackerOpt.MM.UseVelocityModel,TrackerOpt.LH.wightedAv, ConvertVector2String([TrackerOpt.AM.SGM.UPdateGenerativeModel  TrackerOpt.AM.PGM.UPdateGenerativeModel  TrackerOpt.AM.PCAGM.UPdateGenerativeModel],'%3.2f'),TrackerOpt.AM.UpdateOpt.NumExamples,ConvertVector2String([TrackerOpt.AM.UpdateOpt.collectPreviousExpInitial TrackerOpt.AM.UpdateOpt.collectPreviousExpEveryUpdate],'%3.2f') ,TrackerOpt.AM.SGM.Initial.ExchangePositiveExamples2BeNeg,...
        TrackerOpt.MM.WindowLastIteration,mean(ResultsOpts.TimeResults.TimePerFrame),std((ResultsOpts.TimeResults.TimePerFrame)),TrackerOpt.AM.SDC.update.limitPos,DatasetInfo.StartFrame,DatasetInfo.LastValue,TrackerOpt.DA.ReInitializeSDCforMerged,TrackerOpt.DA.ReInitializeSDCforAfterMerge,...
        TrackerOpt.DA.ChooseHighSimilarDetectioninMerge,TrackerOpt.AM.SDC.update.ThresholdSDC,TrackerOpt.CM.DetectorupRate,TrackerOpt.AM.UpdateOpt.RuleUpdateType, TrackerOpt.MM.VelocityMotionModel.Sigmax, TrackerOpt.MM.VelocityMotionModel.SigmaVx,TrackerOpt.DA.ThresholdInMerge,TrackerOpt.AM.UpdateOpt.UseBetweenKeyframes,TrackerOpt.AM.UpdateOpt.UsePastBetweenKeyframes,TrackerOpt.AM.SDC.update.num_pUpdate,TrackerOpt.AM.SDC.update.num_nUpdate,...
        DetectorObj.ScaleFactor,TrackerOpt.DA.ThresholdSimilarityForNewTracker,TrackerOpt.DA.SimilarityType,TrackerOpt.DA.ThresholdVSimilarity,TrackerOpt.DA.FactorSigPosVelocity,TrackerOpt.DA.UseHorizontalVelocityOnlySim,TrackerOpt.AM.SGM.Update.SGMlearnRate,...
        TrackerOpt.AM.UpdateOpt.collectPreviousExpEveryUpdate ,TrackerOpt.AM.UpdateOpt.collectPreviousExpInitial,TrackerOpt.LH.UseGatePositionforLikeLihood ,TrackerOpt.LH.ThresholdVLikelihood,TrackerOpt.LH.UseHorizontalVelocityOnlyLikelihood,TrackerOpt.LH.FactorSigPosVelocityLike,...
        TrackerOpt.AM.UpdateOpt.MinNumerOfConnectedFrames,TrackerOpt.AM.UpdateOpt.SafeOcclusionThreshold,TrackerOpt.AM.SDC.update.ThresholdSDC_Safe,TrackerOpt.LH.LikeliHoodThreshold,TrackerOpt.AM.SGM.Update.thrErrorSGM,TrackerOpt.AM.SGM.Update.lambda_thrSGM,TrackerOpt.AM.SGM.Update.lambdaSGM,...
        TrackerOpt.MM.ComputeLeftRightVelocity,TrackerOpt.DA.GMType,TrackerOpt.DA.SigmaPCAGM,TrackerOpt.AM.SDC.update.NkeyFramesPos,TrackerOpt.AM.SDC.update.NkeyFramesNeg,ResultsOpts.TwoDPCA_var.FeatureSize2DPCA,ResultsOpts.TwoDPCA_var.r_2DPCA,ResultsOpts.TwoDPCA_var.Alpha2DPCA,ResultsOpts.OneDPCA_var.FeatureSizePCA,ResultsOpts.OneDPCA_var.k_PCA,ResultsOpts.OneDPCA_var.AlphaPCA,...
        TrackerOpt.DA.DoubleHightInOverlap,TrackerOpt.DA.ScaleBBOpt.ScaleFactorW,TrackerOpt.DA.ScaleBBOpt.ScaleFactorH};
    SystemParameters3={ClearMOT.MOTP ,ClearMOT.MOTA ,ClearMOT.rateFN ,ClearMOT.rateFP ,ClearMOT.rateTP ,ClearMOT.TP ,ClearMOT.FN ,ClearMOT.FP ,ClearMOT.IDSW,...
        DetectorObj.FilterDetectionsLessThanAvSize,TrackerOpt.DA.useMerge,TrackerOpt.DA.SplitThreshold,TrackerOpt.DA.removeMergedOBjectsFromTermination,TrackerOpt.DA.UseMasterSlaveMerge,TrackerOpt.DA.ReInitializeSDCforMerged,TrackerOpt.DA.ReInitializeSDCforAfterMerge,...
        TrackerOpt.DA.ChooseHighSimilarDetectioninMerge,TrackerOpt.DA.ExchangeDetections,TrackerOpt.DA.OverlapTh2Exchange,TrackerOpt.DA.ConflictOverlapThreshold,TrackerOpt.DA.useOnHoldMissedDetections,TrackerOpt.DA.TrustKeyFramesThreshold,...
        TrackerOpt.DA.CheckOnHoldDetectionsBeforeCreateNew,TrackerOpt.DA.CheckInvalidOnly, TrackerOpt.DA.CheckValidOnly,TrackerOpt.DA.ReInitializeAll, TrackerOpt.DA.ThMaxWaitOnHoldFrames,TrackerOpt.DA.ThresholdSimilarityCheckOnHold, TrackerOpt.AM.SDC.SDCModelConfidenceMethod,...
        TrackerOpt.MM.WindowSizeToMeasureVelocity,TrackerOpt.MM.UseVelocityModel1, TrackerOpt.MM.UseVelocityModel2,TrackerOpt.MM.Vecolity1inMerge, TrackerOpt.MM.Vecolity2inMerge,TrackerOpt.MM.VelocityMotionModel.Window,TrackerOpt.MM.WindowMissTest,TrackerOpt.MM.ChangeDirectionCheck, GTFrom,TrackerOpt.CM.UseWeightedDetections,TrackerOpt.MM.SumVelocityTwice,TrackerOpt.CM.DetectorWeight,DetectorObj.FilterDetectionsLessThanTh,TrackerOpt.DA.ThresholdOverlapDt2TrKeyframe,TrackerOpt.DA.CheckOnHoldOnly,TrackerOpt.AM.SDC.useSparseRep,TrackerOpt.AM.SDC.UseFeatureSelection,TrackerOpt.MM.USeInstantVelocity,...
        TrackerOpt.CM.NewBorn};
    SystemParameters4={ClearMOT.MOTP ,ClearMOT.MOTA ,ClearMOT.rateFN ,ClearMOT.rateFP ,ClearMOT.rateTP ,ClearMOT.TP ,ClearMOT.FN ,ClearMOT.FP ,ClearMOT.IDSW,ClearMOT.IDSW,FinalMetrics.MOTA,FinalMetrics.TruePR, FinalMetrics.FalseNR, FinalMetrics.FalsePR,VOCscore,DatasetInfo.Sequence };
    SystemParameters5={TrackerOpt.MM.opt.UseColorImage, TrackerOpt.MM.opt.UseLBP, TrackerOpt.MM.opt.Use2DHOG, TrackerOpt.MM.opt.Use2DDCT, TrackerOpt.MM.opt.UseIntegralChannel, TrackerOpt.MM.opt.HOGParam.cellpw, TrackerOpt.MM.opt.HOGParam.nthet, TrackerOpt.MM.opt.HOGParam.clip, TrackerOpt.MM.opt.HOGParam.softBin, TrackerOpt.MM.opt.HOGParam.useHog,...
        TrackerOpt.MM.opt.HOGParam.NLayers, TrackerOpt.AM.SDC.NormVector, TrackerOpt.MM.opt.DCTParam.CLIP, TrackerOpt.MM.opt.DCTParam.BlockSize, TrackerOpt.MM.opt.DCTParam.FlagTransform, TrackerOpt.MM.opt.DCTParam.mPad, TrackerOpt.MM.opt.DCTParam.nPad, TrackerOpt.AM.SDC.gamma, TrackerOpt.MM.opt.warpType};
    SystemParameters6={ClearMOT.MOTP ,ClearMOT.MOTA ,ClearMOT.rateFN ,ClearMOT.rateFP ,ClearMOT.rateTP ,ClearMOT.TP ,ClearMOT.FN ,ClearMOT.FP ,ClearMOT.IDSW,...
        DetectorObj.DetectorName,DatasetInfo.FinalNoFrames,TrackerOpt.AM.UpdateOpt.SafeOcclusionThreshold,TrackerOpt.AM.SDC.update.ThresholdSDC_Safe,TrackerOpt.LH.LikeliHoodThreshold,TrackerOpt.AM.SGM.Update.thrErrorSGM,TrackerOpt.AM.SGM.Update.lambda_thrSGM,TrackerOpt.AM.SGM.Update.lambdaSGM,...
        TrackerOpt.MM.ComputeLeftRightVelocity,TrackerOpt.DA.GMType,TrackerOpt.DA.SigmaPCAGM,TrackerOpt.AM.PCAGM.OH.SigmaConfuse,TrackerOpt.AM.PGM.OH.SigmaConfuse,TrackerOpt.AM.OH.ModelType};
    SystemParameters7={ClearMOT.MOTP ,ClearMOT.MOTA ,ClearMOT.rateFN ,ClearMOT.rateFP ,ClearMOT.rateTP ,ClearMOT.TP ,ClearMOT.FN ,ClearMOT.FP ,ClearMOT.IDSW,...
        TrackerOpt.CM.NewBorn, opt.numsample, mean(ResultsOpts.TimeResults.TimePerFrame), std(ResultsOpts.TimeResults.TimePerFrame),...
        ResultsOpts.TimeResults.PercentEachSubject(1),ResultsOpts.TimeResults.PercentEachSubject(2),ResultsOpts.TimeResults.PercentEachSubject(3),ResultsOpts.TimeResults.PercentEachSubject(4),ResultsOpts.TimeResults.PercentEachSubject(5),ResultsOpts.TimeResults.PercentEachSubject(6),...
        ResultsOpts.TimeResults.PercentEachSubject(7),ResultsOpts.TimeResults.PercentEachSubject(8),ResultsOpts.TimeResults.PercentEachSubject(9),ResultsOpts.TimeResults.PercentEachSubject(10),ResultsOpts.TimeResults.PercentEachSubject(11),mean(ResultsOpts.TimeResults.NumberOfTrackers_t),...
        ResultsOpts.TimeResults.MeanTimeUpdate, ResultsOpts.TimeResults.MeanUpdateTimePerTargetPerFrame,ResultsOpts.TimeResults.MeanTimeDataAssociation,ResultsOpts.TimeResults.MeanTimeTrainSGM,ResultsOpts.TimeResults.MeanTimeTrain2DCPA,ResultsOpts.TimeResults.MeanTimeTrain1DCPA};
    SystemParameters8={OutMetrics.Rcll,OutMetrics.Prcn,OutMetrics.FAR,OutMetrics.GT,OutMetrics.MT,OutMetrics.PT,OutMetrics.ML,OutMetrics.FP,OutMetrics.FN,OutMetrics.IDs,OutMetrics.FM,OutMetrics.MOTA,OutMetrics.MOTP,OutMetrics.MOTAL,GTOpt.GtName,DetectorObj.DetectorName,TrackerOpt.GM.Name,OutMetrics.TrajectoryRecall,OutMetrics.TrajectoryPrec,TxtFileName,OutMetrics.OverlapTh};
    xlswrite(ResultsOpts.SaveParameters, SystemParameters1, 'sheet1',SystemParametersCellStartNum);
    xlswrite(ResultsOpts.SaveParameters, SystemParameters2, 'sheet2',SystemParametersCellStartNum);
    xlswrite(ResultsOpts.SaveParameters, SystemParameters3, 'sheet3',SystemParametersCellStartNum);
    xlswrite(ResultsOpts.SaveParameters, SystemParameters4, 'sheet4',SystemParametersCellStartNum);
    xlswrite(ResultsOpts.SaveParameters, SystemParameters5, 'sheet5',SystemParametersCellStartNum);
    xlswrite(ResultsOpts.SaveParameters, SystemParameters6, 'sheet6',SystemParametersCellStartNum);
    xlswrite(ResultsOpts.SaveParameters, SystemParameters7, 'sheet7',SystemParametersCellStartNum);
    xlswrite(ResultsOpts.SaveParameters, SystemParameters8, 'sheet8',SystemParametersCellStartNum);
end